package utils

import "github.com/Miso-Code/buildpacks-ci/cve-notification-app/services"

func GetCVEDescription(cve services.NVDNistResponseCVE) string {
	description := "No description available"
	for _, desc := range cve.Descriptions {
		if desc.Lang == "en" {
			description = desc.Value
		}
	}

	return description
}

func GetCVESeverity(cve services.NVDNistResponseCVE) (string, float64) {
	cveSeverity := "Unknown"
	cveScore := 0.0
	if cve.Metrics.CvssMetricV3 != nil {
		cveSeverity = cve.Metrics.CvssMetricV3[0].CvssData.BaseSeverity
		cveScore = cve.Metrics.CvssMetricV3[0].CvssData.BaseScore
	} else if cve.Metrics.CvssMetricV2 != nil {
		cveSeverity = cve.Metrics.CvssMetricV2[0].CvssData.BaseSeverity
		cveScore = cve.Metrics.CvssMetricV2[0].CvssData.BaseScore
	}

	return cveSeverity, cveScore
}
