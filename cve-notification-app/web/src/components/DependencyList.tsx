import React from 'react';
import { List, ListItem, ListItemText, Switch, Button, IconButton } from '@mui/material';
import DeleteIcon from '@mui/icons-material/Delete';
import { Dependency, DependencyWithIntegration } from '../context';

interface DependencyListProps {
    dependencies: Dependency[];
    userDependencies: DependencyWithIntegration[];
    onActivate: (index: number) => void;
    onConfig: (dependency: DependencyWithIntegration) => void;
    onDelete: (dependencyId: string) => void;
}

const DependencyList: React.FC<DependencyListProps> = ({ dependencies, userDependencies, onActivate, onConfig, onDelete }) => {
    return (
        <List>
            {userDependencies.map((userDep, index) => {
                const dependency = dependencies.find(dep => dep.id === userDep.dependency_id);
                return (
                    <ListItem key={"dependency"+index}>
                        <ListItemText>
                            {dependency ? `${dependency.vendor} - ${dependency.product}` : userDep.dependency_id}
                        </ListItemText>
                        <Switch edge="start" checked={userDep.integration.active} onChange={() => onActivate(index)} />
                        <Button variant='outlined' disabled={!userDep.integration.active} onClick={() => onConfig(userDep)}>Config</Button>
                        <IconButton edge="end" aria-label="delete" onClick={() => onDelete(userDep.dependency_id)}>
                            <DeleteIcon />
                        </IconButton>
                    </ListItem>
                );
            })}
        </List>
    );
}

export default DependencyList;
